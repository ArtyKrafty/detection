<a href="#ENG"><img src='https://img.shields.io/badge/RUS-ENG-blue'></a>

<a id='RUS'></a>

<p float="left">
  <img src='https://img.shields.io/badge/mac%20os-000000?style=for-the-badge&logo=macos&logoColor=F0F0F0'>
  <img src='https://img.shields.io/badge/Windows-0078D6?style=for-the-badge&logo=windows&logoColor=white'> 
  <img src='https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=ubuntu&logoColor=white'> 
  
   
</p>


<h2 align="center">–ú–æ–¥—É–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenCV –∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ Python —Å –ø–æ–º–æ—â—å—é Detectron2. Pipeline, web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ </h2>


<p align="center"><img src='https://i.ibb.co/rbJmBSV/Computer-Vision-Object-Detection-original.jpg'></p>

<a id='link6'></a>



–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:  

- [–ú–æ—Ç–∏–≤–∏—Ä–æ–≤–∫–∞](#link1)  
- [–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞](#link2)  
   - [–°–∫—Ä–∏–ø—Ç process_img.py](#link3)  
   - [–°–∫—Ä–∏–ø—Ç process_video.py](#link4)   
- [Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](#link5) 
- [Dockerfile](#link)
- [–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞](#linkvmru)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞](#linkprobru)
- [–í—ã–≤–æ–¥—ã](#summru)
- [–°—Å—ã–ª–∫–∏](#linkru001)


---

üìù WEB-–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Å–ø—è—â–µ–º —Ä–µ–∂–∏–º. –î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—Ä–µ–º—è - –ø—Ä–∏–º–µ—Ä–Ω–æ `30 —Å–µ–∫—É–Ω–¥` –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å—Å—ã–ª–∫–µ. 
–¢–∞–∫–∂–µ, –≤–æ–∑–º–æ–∂–Ω—ã —Å–±–æ–∏ –≤ —Ä–∞–±–æ—Ç–µ - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ. –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å–µ—Ä–≤–∏—Å–∞ [Cloudinary](https://cloudinary.com/console/c-d40c93f179ad3e2d4db90096a7d9fe/getting-started), —Ç–∞–∫ –∫–∞–∫ `heroku` –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –∑–∞—Ä—É–∑–∫—É –Ω–∞ —Å–≤–æ–∏ —Å–µ—Ä–≤–µ—Ä–∞
–§–æ—Ç–æ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è. 




<p align="center"><img src="https://i.ibb.co/X4W8wCw/2022-01-03-02-23-14.png" alt="2022-01-03-02-23-14" border="0"></p>


üìù –û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏, –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –µ—â–µ —Ä–∞–∑ (–≤ –±—Ä–∞—É–∑–µ—Ä–µ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é 
—Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –Ω–∞–∂–º–∏—Ç–µ `–û—Ç–ø—Ä–∞–≤–∏—Ç—å` –µ—â–µ —Ä–∞–∑) –∏–ª–∏ –≤–∑—è—Ç—å –¥—Ä—É–≥—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É. –° –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–æ–π –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç

> üìù `Update` - –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ `–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö`, 
> –±—ã–ª–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ `–í–ú` [Ya.Cloud](https://cloud.yandex.ru/services/compute?utm_source=google&utm_medium=cpc&utm_campaign=Search_RU_Other_All_LGEN_Compute_cloud|1665315027&utm_term=&utm_content=k50id|dsa-1095774648190|cid|1665315027|aid|536548145022|gid|115436434013|pos||src|g_|dvc|c|reg|9040981|rin||&gclid=Cj0KCQiA_c-OBhDFARIsAIFg3eyjfkECcbvr56__gTM6WeTu4I4CsK8_PNLkyYxi1niax0HbaNtwHrgaAp0jEALw_wcB) - –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ [—ç—Ç–æ–π —Å—Å—ã–ª–∫–µ](http://51.250.20.81:8080/)

---

<h3 align="center">–ú–æ—Ç–∏–≤–∏—Ä–æ–≤–∫–∞</h3><a id='link1'></a>

–ú–æ–¥—É–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º [OpenCV](https://opencv.org/) –∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ `Python` —Å –ø–æ–º–æ—â—å—é [Detectron2](https://github.com/facebookresearch/detectron2). –ò–¥–µ—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π `pipeline` –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏ `DS`. –ò–¥–µ—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ –≤–∑—è—Ç–∞ —É [Aros≈Çaw Gilewski](https://medium.com/deepvisionguru/modular-image-processing-pipeline-using-opencv-and-python-generators-9edca3ccb696) –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω–∞
–ø–æ–¥ `Detectron2`, –±—ã–ª–∏ —É—á—Ç–µ–Ω—ã –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π - –≤ –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –¥–æ–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –Ω—É–∂–Ω—ã—Ö –Ω–∞–º –≤–∞—Ä–∏–∞—Ü–∏—è—Ö.  

–¶–µ–ª—å—é —Ä–∞–±–æ—Ç—ã –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–≤ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è `Detectron2` –∏ `OpenCV` –≤ –ø—Ä–æ–µ–∫—Ç—ã - –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ `web` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥—É–ª–µ–π 
–∏–ª–∏ –∂–µ –≤ –≤–∏–¥–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–µ–π, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–¥—É–ª–µ–π –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å
—Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º, –≤–æ–∑–Ω–∏–∫–∞—é—â–∏—Ö –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å `torch` –∏ `Detectron2` –≤ —Ä–∞–∑—Ä–µ–∑–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å, –Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞, 
–µ—Å–ª–∏ –≤—ã –≤–¥—Ä—É–≥ –∑–∞—Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã–π –º–æ–¥—É–ª—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö


> üìù –ï—Å–ª–∏ —É –í–∞—Å –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ `medium` - –≤–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ `Google Chrome`

1. **–õ–æ–∫–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ**. –í –¥–∞–Ω–Ω–æ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ - –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å–ª—É—á–∞–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –ª–∏–±–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å **–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏
–æ—Ä—É–∂–∏—è**, –≤ —Ç–æ–º —á–∏—Å–ª–µ –Ω–∞ –≤–∏–¥–µ–æ. –ü—Ä–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç, –Ω–µ —É–≥–ª—É–±–ª—è—è—Å—å –≤ –∫–æ–¥, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ –∑–∞—Ç–µ–Ω—è—Ç—å —Ñ–æ–Ω. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `GPU`  

   –î–æ—Å—Ç—É–ø–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:  

      - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
        - –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–∞–ø–∫–∞–º–∏! –Ω–µ —Ç–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—á–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
        - Instance segmentation –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
        - Keypoints
        - –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ (separate background)
        - Panoptic segmentation
        - –î–µ—Ç–µ–∫—Ü–∏—è –æ—Ä—É–∂–∏—è (custom dataset)
      - –í–∏–¥–µ–æ:
        - –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–∞–ø–∫–∞–º–∏! –Ω–µ —Ç–æ–ª—å–∫–æ –µ–¥–∏–Ω–∏—á–Ω—ã–º–∏ –≤–∏–¥–µ–æ —Ñ–∞–π–ª–∞–º–∏
        - Instance segmentation –Ω–∞ –≤–∏–¥–µ–æ
        - –ü–æ–∫–∞–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
        - –î–µ—Ç–µ–∫—Ü–∏—è –æ—Ä—É–∂–∏—è –Ω–∞ –≤–∏–¥–µ–æ
        
        –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GPU!
        
        
        
  <p align="center"><img src="https://i.ibb.co/ZJSL1yL/2021-12-28-10-43-20.png" alt="2021-12-28-10-43-20" border="0"></p>
  
  
 > üìù –ü–æ–¥–æ–π–¥–µ—Ç —Ç–µ–º, –∫—Ç–æ —Ö–æ—á–µ—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–¥—É –∏ –æ–±–ª–∞–¥–∞—Ç—å –±–æ–ª—å—à–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –Ω–∞–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.   
 > üìù –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã –≤ –ø–∞–ø–∫–µ `output` –∏ –ø–æ —Ç–µ–∫—Å—Ç—É `Readme.md`


```python

-- —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è --

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: process_img.py -> detection.pipe.py -> detction.capture_imgs.py -> 
-> detection.predict.py -> detection.annotate_img.py –∏–ª–∏ detection.separate_background.py -> 
-> detection.save_img.py

–í–∏–¥–µ–æ: process_vid.py -> detection.pipe.py -> detection.capture_vid.py -> 
-> detection.predict.py -> detection.annotate_vid.py -> 
-> detection.save_vid.py -> detection.display_vid.py

```
  
2. **Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ `web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ` —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é (—Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) - –ù–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É: https://detartyseg.herokuapp.com/ –∏ –ø–æ [—ç—Ç–æ–π —Å—Å—ã–ª–∫–µ –≤ Ya.Cloud](http://51.250.20.81:8080/). –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é - –ø—Ä–∏—à–ª–æ—Å—å –æ–±—Ä–µ–∑–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –¢–∞–∫–∂–µ, –≤–æ–∑–º–æ–∂–µ–Ω –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ [Docker](https://www.docker.com/) - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —á–∞—Å—Ç–∏ —Ñ–∞–π–ª–∞ [Readme.md](#link) - –ª–æ–∫–∞–ª—å–Ω–æ, –ª–∏–±–æ –ø–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è - –∑–∞–ø—É—Å —á–µ—Ä–µ–∑ `app_local.py`  

   –î–æ—Å—Ç—É–ø–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:  

      - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
        - –†–∞–±–æ—Ç–∞–µ—Ç —Å –µ–¥–∏–Ω–∏—á–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
        - Instance segmentation –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
        - Keypoints –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
        - Panoptic segmentation –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö (`–£–î–ê–õ–ï–ù–û –∏–∑ heroku. –î–æ—Å—Ç—É–ø–Ω–æ –≤ docker –∏ yaCloud`)
        - –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ (separate background)
        - Blur —ç—Ñ—Ñ–µ–∫—Ç
        - –ß–µ—Ä–Ω–æ-–±–µ–ª–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

        —Ç–æ–ª—å–∫–æ CPU


<p align="center"><img src="https://i.ibb.co/mDCxTP3/2022-01-03-11-27-44.png" alt="2022-01-03-11-27-44" border="0"></p>
 
> üìù –ü–æ–¥–æ–π–¥–µ—Ç —Ç–µ–º, –∫—Ç–æ –Ω–µ —Ö–æ—á–µ—Ç —Ç—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ - –∞ —Å—Ä–∞–∑—É –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ï—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –≤ –≤–∏–¥–µ [Docker](#link) —Å–±–æ—Ä–∫–∏

```python

-- —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è --

app.py —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Flask - –∑–∞–≥—Ä—É–∑–∫–∞ css –∏ html –∏–∑ static –∏ templates. 
–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ Api Cloudly

```

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>


<h3 align="center">–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞</h3><a id='link2'></a>
<h4> 1. –°–∫—Ä–∏–ø—Ç process_img.py</h4><a id='link3'></a>

–ó–¥–µ—Å—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –ø—è—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏:   

- `instance segmentation` –Ω–∞ –∫–ª–∞—Å—Å—ã `COCO`
- `instance segmentation` –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ä—É–∂–∏—è –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–º [–¥–∞—Ç–∞—Å–µ—Ç–µ](https://github.com/ArtyKrafty/detection/blob/main/configs/COCO-InstanceSegmentation_weapon/weapon_data.tar). –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª–∏ –≤–∑—è—Ç—ã —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è [MLWhiz](https://github.com/MLWhiz/object_detection), –∫–æ—Ç–æ—Ä—ã–µ —è —Ä–∞–∑–º–µ—Ç–∏–ª –≤—Ä—É—á–Ω—É—é —Å –ø–æ–º–æ—â—å—é [supervise.ly](https://supervise.ly/).    

> –û–±—É—á–µ–Ω–∏–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —ç—Ç–æ–º [–Ω–æ—É—Ç–±—É–∫–µ](https://nbviewer.org/github/ArtyKrafty/detection/blob/main/configs/COCO-InstanceSegmentation_weapon/weapon_detection_ipynb__.ipynb), –µ—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –æ–±—É—á–∏—Ç—å —Å–≤–æ–π –¥–µ—Ç–µ–∫—Ç–æ—Ä (–¥–æ—Å—Ç—É–ø–Ω–æ –∏ –≤ [Collab](https://colab.research.google.com/drive/1TOSFHYrQrxToQ4v5azP8xzpuLcgEKrQ3?usp=sharing)). –í–µ—Å–∞ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –º–æ–∂–Ω–æ –±—Ä–∞—Ç—å –∏–∑ [–∑–æ–æ–ø–∞—Ä–∫–∞](https://github.com/facebookresearch/detectron2/blob/main/detectron2/model_zoo/model_zoo.py) - —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å `.yaml` –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º –≤ –ø–∞–ø–∫–µ `config`
- `separate background` - –æ—Ç–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞, –≤–º–µ—Å—Ç–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏. –ò–¥–µ—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∞ [Aros≈Çaw Gilewski](https://medium.com/deepvisionguru/how-to-embed-detectron2-in-your-computer-vision-project-817f29149461)
- `keypoints` - –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫ –ª—é–¥–µ–π –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö (`pose-flow`)
- `panoptic segmentation` - –¥–ª—è –ø–∞–Ω–æ–ø—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π


–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∑–∞–ø—É—Å–∫–∞, –¥–∞–Ω–Ω–æ–º—É –º–æ–¥—É–ª—é –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ `GUI`, —Å –ø–æ–º–æ—â—å—é [GOOEY](https://github.com/chriskiehl/Gooey)

---

<h3 align="center">–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ</h3>

---



–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤ `virtuenv`. –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥ - –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å

```python
pip install virtualenv
virtualenv detection
source detection/bin/activate
```


–¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ—á–∏—Ç–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–æ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –î–ª—è `Win` —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Ubuntu 20.04.3 LTS` —Å `WLS2` –∏–ª–∏ `Conda` —Ç–µ—Ä–º–∏–Ω–∞–ª. –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, —á—Ç–æ–±—ã —É –≤–∞—Å —É–∂–µ —Å—Ç–æ—è–ª–∞ [Anaconda](https://www.anaconda.com/products/individual)


–®–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è. 

```python
git clone https://github.com/ArtyKrafty/detection
pip install -r requirements_loc.txt
```

Detectron2 –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Å–æ—Å–µ–¥–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ —Å –ø–∞–ø–∫–æ–π –º–æ–¥—É–ª—è

<p align="center"><img src="https://i.ibb.co/R25y4Lx/2021-12-26-19-35-04.png" alt="2021-12-26-19-35-04" border="0"></p>

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ `Detectron2`

```python
cd

git clone https://github.com/facebookresearch/detectron2.git
python -m pip install -e detectron2

# –ù–∞ macOS, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–∫ (–æ—Å–æ–±–µ–Ω–Ω–æ, –µ—Å–ª–∏ —É –≤–∞—Å M1)
CC=clang CXX=clang++ ARCHFLAGS="-arch x86_64" python -m pip install -e detectron2

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –º–æ–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –°++ compiler 
conda install -c conda-forge compilers

```
[–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Detectron2](https://github.com/facebookresearch/detectron2/blob/3def12bdeaacd35c6f7b3b6c0097b7bc31f31ba4/INSTALL.md).   
[–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Detectron2. Installation](https://detectron2.readthedocs.io/en/latest/tutorials/install.html)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º –∫ —Ä–∞–±–æ—Ç–µ, –Ω–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Ä–µ—à–µ–Ω–∏—è, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏

–î–ª—è `Win` —É –≤–∞—Å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `Visual C++ 2015 build tools`   
–ï—Å–ª–∏ –Ω–µ—Ç - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [–æ—Ç—Å—é–¥–∞](https://www.microsoft.com/ru-ru/download/confirmation.aspx?id=48159)  - —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è [Detectron2](https://github.com/philferriere/cocoapi)


–¢–∞–∫–∂–µ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é `torch` –∏ `torchvision` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ [—Ç—É—Ç](https://pytorch.org/get-started/locally/) - 
–≤—ã–±–∏—Ä–∞–µ–º Package - –∫–æ–ø–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏


<p align="center"><img src="https://i.ibb.co/wc1NPMq/123.jpg" alt="123" border="0"></p> 


> üìù –ï—Å–ª–∏ —É –≤–∞—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞ - `Torchvision error: Could not find module image.pyd` - —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è [–∑–¥–µ—Å—å](https://kontext.tech/column/python/915/torchvision-error-could-not-find-module-imagepyd) —Å —Ä–µ—à–µ–Ω–∏–µ–º

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `CPU`:

```python
pip3 install torch torchvision torchaudio
–∏–ª–∏
conda install pytorch torchvision cpuonly -c pytorch

```

---

<h3 align="center">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è</h3>

---


1. `Instance segmentation` –Ω–∞ –∫–ª–∞—Å—Å—ã `COCO`

```python
–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª

cd detection
pythonw process_img.py

```

> üìù –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤—ã–∑–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `pythonw`, –Ω–µ `python` –∏–ª–∏ `python3`

–£ –≤–∞—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ:

<p align="center"><img src="https://i.ibb.co/ZJSL1yL/2021-12-28-10-43-20.png" alt="2021-12-28-10-43-20" border="0"></p>


```python
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å input. –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç—ã. 
–í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ - –ø–∞–ø–∫–∞

./examples/images/photo/

—Ç–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ confidence. 
–ù–∞–∂–∏–º–∞–µ–º START –∏ –≤ –ø–∞–ø–∫–µ outputs —É –≤–∞—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

```
<p align="center"><img src="https://i.ibb.co/pz0Twxx/0299ce77-30e4-4b31-b8e5-fad85b140111.jpg" alt="0299ce77-30e4-4b31-b8e5-fad85b140111" border="0"></p>

> –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö –Ω–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –æ—Ç—Ä–∞–±–æ—Ç–∫–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã –≤ `COCO` –¥–∞—Ç–∞—Å–µ—Ç–µ

2. `Instance segmentation` –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ä—É–∂–∏—è –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–º [–¥–∞—Ç–∞—Å–µ—Ç–µ](https://github.com/ArtyKrafty/detection/blob/main/configs/COCO-InstanceSegmentation_weapon/weapon_data.tar). –ù–∞–∑–≤–∞–Ω–∏—è–º–∏ –∫–ª–∞—Å—Å–æ–≤ –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–µ–Ω–µ–±—Ä–µ—á—å - –∏–Ω–∞—á–µ –ø–æ—Ç–µ—Ä—è–ª–∏ –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ —Å–æ–±—Ä–∞—Ç—å —Å–µ—Ç –±–æ–ª—å—à–µ - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
–Ω–∞–ª–∏—á–∏—è –æ—Ä—É–∂–∏—è —É —á–µ–ª–æ–≤–µ–∫–∞

```python
–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª

cd detection
pythonw process_img.py

```

> üìù –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤—ã–∑–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `pythonw`, –Ω–µ `python` –∏–ª–∏ `python3`

–£ –≤–∞—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ:

<p align="center"><img src="https://i.ibb.co/1TmBmfX/2021-12-28-10-10-42.png" alt="2021-12-28-10-10-42" border="0"></p>


```python
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å input. –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç—ã. 
–í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ - –ø–∞–ø–∫–∞

./examples/images/weapon/

—Ç–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ confidence. –¢—É—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å - 
–≤—ã –Ω–∞–π–¥–µ—Ç–µ –Ω—É–∂–Ω—É—é –≤ –ø–∞–ø–∫–µ config (–∏ –≤–µ—Å–∞ –∫ –Ω–µ–π):   


–ø—É—Ç—å ./detection/configs/COCO-InstanceSegmentation_weapon/mask_rcnn_R_50_FPN_3x.yaml. 
–ì—Ä—É–∑–∏–º –∫ –Ω–µ–π –≤–µ—Å–∞: ./detection/configs/COCO-InstanceSegmentation_weapon/model_final.pth
–ù–∞–∂–∏–º–∞–µ–º START –∏ –≤ –ø–∞–ø–∫–µ outputs —É –≤–∞—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```
<p align="center"><img src="https://i.ibb.co/8M9Bt3T/new-use-hotel-robber-with-gun-2.jpg" alt="new-use-hotel-robber-with-gun-2" border="0"></p>

> –∑–¥–µ—Å—å –ø—Ä–∏—à–ª–æ—Å—å –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä–µ–º –∫–ª–∞—Å—Å–æ–≤, —á—Ç–æ–±—ã –±—ã–ª–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å - –æ—Ä—É–∂–∏–µ –Ω–µ –±—ã–ª–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–µ–ª—å—é –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è,
> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞, –∫–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –º–∏—Ä–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö, –∞ —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑–∞—Ç—å
> `baseline` –æ–±—É—á–µ–Ω–∏—è —Å–≤–æ–µ–≥–æ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞

3. –û—Ç–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞ - —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–º–µ—Ç–∫—É separate_background

```python
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å input. –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç—ã. 
–í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ - –ø–∞–ø–∫–∞

./examples/images/photos/

—Ç–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ confidence. –¢—É—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å - 
–≤—ã –Ω–∞–π–¥–µ—Ç–µ –Ω—É–∂–Ω—É—é –≤ –ø–∞–ø–∫–µ config (–∏ –≤–µ—Å–∞ –∫ –Ω–µ–π):   


–ø—É—Ç—å ./detection/configs/COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x.yaml. 
–°—Ç–∞–≤–∏–º –æ—Ç–º–µ—Ç–∫—É - separate background:
–ù–∞–∂–∏–º–∞–µ–º START –∏ –≤ –ø–∞–ø–∫–µ outputs —É –≤–∞—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

```

–ü–æ–ª—É—á–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å `blur`-—ç—Ñ—Ñ–µ–∫—Ç–æ–º –Ω–∞ —Ñ–æ–Ω - –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –º–∞—Å–∫—É –∏ –≤–º–µ—Å—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –ø–æ–ª—É—á–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –æ—Ç —Ñ–æ–Ω–∞ –æ–±—ä–µ–∫—Ç—Ä

<p align="center"><img src="https://i.ibb.co/Q9m5nHh/004.jpg" alt="004" border="0"></p>

> –º–æ—è –ª—é–±–∏–º–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - –ø–æ–º–æ–≥–∞–µ—Ç –±–µ–∑ –Ω–∞–≤—ã–∫–æ–≤ `photoshop` —Å–¥–µ–ª–∞—Ç—å –Ω–µ–±–æ–ª—å—à—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–≤–æ–µ–≥–æ —Ñ–æ—Ç–æ

4. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫:

```python
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å input. –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç—ã. 
–í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ - –ø–∞–ø–∫–∞

./examples/images/key_points/

—Ç–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ confidence. –¢—É—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å - 
–≤—ã –Ω–∞–π–¥–µ—Ç–µ –Ω—É–∂–Ω—É—é –≤ –ø–∞–ø–∫–µ config (–∏ –≤–µ—Å–∞ –∫ –Ω–µ–π):   


–ø—É—Ç—å ./detection/configs/COCO-Keypoints/keypoint_rcnn_R_50_FPN_3x.yaml. 
–ù–∞–∂–∏–º–∞–µ–º START –∏ –≤ –ø–∞–ø–∫–µ outputs —É –≤–∞—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

–í–µ—Å–∞ –∑–∞–¥–∞–≤–∞—Ç—å –Ω–µ –Ω–∞–¥–æ. 

```
–ü–æ–ª—É—á–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–º–∏ –∫–ª—é—á–µ–≤—ã–º–∏ —Ç–æ—á–∫–∞–º–∏. –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Å –ª—é–¥—å–º–∏. 


<p align="center"><img src="https://i.ibb.co/0KY5Jh1/predict.jpg" alt="predict" border="0"></p>

> –∑–¥–µ—Å—å –µ—Å—Ç—å –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏, –º–æ–¥–µ–ª—å —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ. –í–æ–∑–º–æ–∂–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è, —Å –ø–æ–º–æ—â—å—é –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏–Ω–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ `pose flow`.
> –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –≤–∑—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ—Ç YuliangXiu [–∑–¥–µ—Å—å](https://github.com/YuliangXiu/PoseFlow)

5. –ü–∞–Ω–æ–ø—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–∫–∞–∑–∞—Ç—å –∞–¥—Ä–µ—Å –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```python
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å input. –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥—É—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç—ã. 
–í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ - –ø–∞–ø–∫–∞

./examples/images/pan/

—Ç–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ confidence. –¢—É—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å - 
–≤—ã –Ω–∞–π–¥–µ—Ç–µ –Ω—É–∂–Ω—É—é –≤ –ø–∞–ø–∫–µ config (–∏ –≤–µ—Å–∞ –∫ –Ω–µ–π):   


–ø—É—Ç—å ./detection/configs/COCO-PanopticSegmentation/panoptic_fpn_R_101_3x.yaml 
–ù–∞–∂–∏–º–∞–µ–º START –∏ –≤ –ø–∞–ø–∫–µ outputs —É –≤–∞—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

–í–µ—Å–∞ –∑–∞–¥–∞–≤–∞—Ç—å –Ω–µ –Ω–∞–¥–æ. 

```

<p align="center"><img src="https://i.ibb.co/Zx9zB1g/predict.jpg" alt="predict" border="0"></p>

> panoptic segmentation —Ç–∞–∫–∂–µ —É–¥–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ - –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é –∏ –≥–ª—É–±–æ–∫—É—é –º–æ–¥–µ–ª—å
> –ª–∏–±–æ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫, –∏–ª–∏ –∂–µ –ø—Ä–æ—Å—Ç–æ - –¥–æ–æ–±—É—á–∏—Ç—å, —Å–æ–±—Ä–∞–≤ —Å–µ—Ç


–¶–µ–ª—å—é –±—ã–ª–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –±–µ–∑ —É–≥–ª—É–±–ª–µ–Ω–∏–π –≤ –∫–æ–¥ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>

<h4> 2. –°–∫—Ä–∏–ø—Ç process_video.py</h4><a id='link4'></a>

–î–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ –∏ –ø–æ–∫–∞–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

<h3 align="center">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è</h3>

---


`Instance segmentation` –Ω–∞ –∫–ª–∞—Å—Å—ã `COCO`

```python
–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª

cd detection
pythonw process_video.py

```

> üìù –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤—ã–∑–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `pythonw`, –Ω–µ `python` –∏–ª–∏ `python3`. –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π. –ú–æ–∂–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ä—É–∂–∏–µ - 
> –ø–æ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º —ç—Ç–∏–∫–∏ - –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ –Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–∞–π–ª —Å –≤–æ–æ—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –Ω–∞–ø–∞–¥–µ–Ω–∏—è–º–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

–£ –≤–∞—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ:

<p align="center"><img src="https://i.ibb.co/KKBhVRy/2021-12-27-23-26-40.png" alt="2021-12-27-23-26-40" border="0"></p>

```python
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å input. –≠—Ç–æ –≤–∏–¥–µ–æ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥—É—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ–±—ä–µ–∫—Ç—ã. 
–í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–æ–∏–º–∏ –ø—Ä–∏–º–µ—Ä–æ–º

./examples/videos/cross_roads.mp4

—Ç–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ confidence. 
–ù–∞–∂–∏–º–∞–µ–º START –∏ –≤ –ø–∞–ø–∫–µ outputs —É –≤–∞—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ. –ó–∞–Ω–∏–º–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è

```
**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** –í–∞–∂–Ω–æ! –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç [bug](https://github.com/facebookresearch/detectron2/issues/3780) –Ω–∞ –∫–ª–∞—Å—Å
`VideoVisualizer`. –ß—Ç–æ–±—ã –µ–≥–æ –æ–±–æ–π—Ç–∏, –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å `Visualizer`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
–ø–æ—ç—Ç–æ–º—É –º–∞—Å–∫–∏ –æ—Ç –∫–∞–¥—Ä–∞ –∫ –∫–∞–¥—Ä—É –º–µ–Ω—è—é—Ç—Å—è. –í–æ–∑–º–æ–∂–Ω–æ bug –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ `M1 silicone`

<p align="center">
  <img src="sample.gif" alt="animated" />
</p>

> —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, –∏–∑ –º–∏–Ω—É—Å–æ–≤ - –Ω–∞–±–ª—é–¥–∞–µ–º –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç—å —Ü–≤–µ—Ç–∞ –º–∞—Å–∫–∏, –≤ –∏–¥–µ–∞–ª–µ - –º–∞—Å–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç–∞—Ç–∏—á–Ω–∞ –∏ –Ω–µ –º–µ–Ω—è—Ç—å —Ü–≤–µ—Ç. –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç,
> –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–∏–±–µ–≥–Ω—É—Ç—å –∫ —Ö–∏—Ç—Ä–æ—Å—Ç–∏ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ç–∫—É –∫–∞–¥—Ä–æ–≤ –∏ —Å–∫–ª–µ–∏–≤–∞—Ç—å –∏—Ö –≤ –≤–∏–¥–µ–æ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>

<h3 align="center">Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h3><a id='link5'></a>


–°–∫—Ä–∏–ø—Ç `app_local.py` - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ



–∑–µ—Ä–∫–∞–ª–æ –¥–ª—è `app.py`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É: https://detartyseg.herokuapp.com/ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤ [yaCloud](http://51.250.20.81:8080/) 
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é - –ø—Ä–∏—à–ª–æ—Å—å –æ–±—Ä–µ–∑–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ü—Ä–∏—à–ª–æ—Å—å —É–±—Ä–∞—Ç—å –ø–∞–Ω–æ–ø—Ç–∏—á–µ—Å–∫—É—é —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é -
–ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ. –û—Å—Ç–∞–ª—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏ `docker`.
–ï—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–µ—Ä–≤–∏—Å–æ–º [heroku](https://dashboard.heroku.com/login) - –í–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –í–∞—à–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º,
–∏ –≤–∞–º –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ - `deploy from git`

<p align="center"><img src="https://i.ibb.co/p1KVj69/2022-01-06-00-11-48.png" alt="2022-01-06-00-11-48" border="0"></p>

> üìù `Update` - –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ `–≤—Ä–µ–º–µ–Ω–Ω–æ, –≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö`, 
> –±—ã–ª–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ `–í–ú` [ya.Cloud](https://cloud.yandex.ru/services/compute?utm_source=google&utm_medium=cpc&utm_campaign=Search_RU_Other_All_LGEN_Compute_cloud|1665315027&utm_term=&utm_content=k50id|dsa-1095774648190|cid|1665315027|aid|536548145022|gid|115436434013|pos||src|g_|dvc|c|reg|9040981|rin||&gclid=Cj0KCQiA_c-OBhDFARIsAIFg3eyjfkECcbvr56__gTM6WeTu4I4CsK8_PNLkyYxi1niax0HbaNtwHrgaAp0jEALw_wcB) - –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ [—ç—Ç–æ–π —Å—Å—ã–ª–∫–µ](http://51.250.20.81:8080/)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ  - –∑–∞–ø—É—Å–∫–∞–µ–º `app_local.py`. –Ω–æ —É –≤–∞—Å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ —É–∂–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–∫–∞–∫ –º—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–ª–∏ –≤—ã—à–µ):


```python
 git clone https://github.com/ArtyKrafty/detection
 cd detection
 python app_local.py
 
```
–ó–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –ø–æ –∞–¥—Ä–µ—Å—É - `http://–í–ê–®_URL_–∏–∑_—Ç–µ—Ä–º–∏–Ω–∞–ª–∞:8080/`


<p align="center"><img src="https://i.ibb.co/mDCxTP3/2022-01-03-11-27-44.png" alt="2022-01-03-11-27-44" border="0"></p>

–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞, –≤—ã–¥–µ–ª–∏—Ç—å –º–∞—Å–∫–∏ –Ω–∞ –Ω–µ–º –∏–ª–∏ –∑–∞—Ç–µ–º–Ω–∏—Ç—å —Ñ–æ–Ω. –¢–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ `URL` - —Ç–æ–ª—å–∫–æ instance segmentation

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>


<h3 align="center">Dockerfile</h3><a id='link'></a>



–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç - –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `Docker` (–ª–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è https://detartyseg.herokuapp.com/) - –≤–µ—Å –æ–±—Ä–∞–∑–∞ `~14.1 GB` (—É –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
[Docker](https://www.docker.com/) - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è):

```python
git clone https://github.com/ArtyKrafty/detection

cd detection

docker build . -f Dockerfile -t detectron2
docker run --name detectron2 -p 127.0.0.1:8080:8080 detectron2


–∑–∞—Ç–µ–º - –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –∑–∞–∫–æ–Ω—á–∏–ª–∏:

docker stop detectron2
docker rm $(docker ps -qa)

–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-desktop –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–æ–±–Ω–µ–µ

–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏: docker run -t -i detectron2 /bin/bash
```
<p align="center"><img src="https://i.ibb.co/FwgVWJn/123.jpg" alt="123" border="0"></p>

–¢–∞–∫–∂–µ, –≤—ã –º–æ–∂–µ—Ç–µ —Å –ø–æ–º–æ—â—å—é `Dockerfile` –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–∞—à–µ–π `–í–ú`

> üìù –ï—Å–ª–∏ —É –≤–∞—Å `MacOS` - –∑–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `docker -> advanced` –∏ —É–≤–µ–ª–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å `RAM` —Å 2 –¥–æ 4 –ì–ë - –∏–Ω–∞—á–µ `–°++` –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä 
–Ω–µ —Å–º–æ–∂–µ—Ç —Å–æ–±—Ä–∞—Ç—å `torch`

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>


<h3 align="center">–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞</h3><a id='linkvmru'></a>

–° –ø–æ–º–æ—â—å—é `Dockerfile` –í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ` –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É.  –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ `Vm` - `8gb Ram`, `vCpu - 50%`, 
`20Gb HDD` - —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–∞–∫–æ–π –º–∞—à–∏–Ω—ã –≤ –º–µ—Å—è—Ü - –ø—Ä–∏–º–µ—Ä–Ω–æ `1700 - 1900 —Ä—É–±`. `Gpu` –ø–æ–¥–∫–ª—é—á–∞—Ç—å –Ω–µ—Ç —Å–º—ã—Å–ª–∞ - —Ä–∞–±–æ—Ç–∞–µ–º —Å –µ–¥–∏–Ω–∏—á–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º—Å—è –Ω–∞ –ª—é–±–æ–º —Å–µ—Ä–≤–∏—Å–µ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–º —É—Å–ª—É–≥–∏ `–í–ú` - –Ω–∞–ø—Ä–∏–º–µ—Ä, —è –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è [Ya.Cloud](https://cloud.yandex.ru/?utm_source=google&utm_medium=cpc&utm_campaign=Search_RU_Msk_All_LGEN_Brand_cloud|8671134894&utm_term=%D1%8F%D0%BD%D0%B4%D0%B5%D0%BA%D1%81%20%D0%BA%D0%BB%D0%B0%D1%83%D0%B4&utm_content=k50id|kwd-972722615673|cid|8671134894|aid|428872413994|gid|85184818777|pos||src|g_|dvc|c|reg|9040981|rin|9047023|&gclid=Cj0KCQiAoNWOBhCwARIsAAiHnEjpHDU6WbRvwmOl1NYDg5M5Zi_pZ-bc0dDwlu8sDRvP555cSH-W4bQaApuWEALw_wcB)

–í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–±–∏—Ä–∞–µ–º - `Compute Cloud`:

<p align="center"><img src="https://i.ibb.co/qFrKRnF/2022-01-05-23-54-18.png" alt="2022-01-05-23-54-18" border="0"></p>

–í—ã–±–∏—Ä–∞–µ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞—à–µ–π –í–ú - `Ubuntu`:

<p align="center"><img src="https://i.ibb.co/RYgXGZR/2022-01-05-23-54-30.png" alt="2022-01-05-23-54-30" border="0"></p>

–ù–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å `ssh-key` –¥–ª—è –æ–±–º–µ–Ω–∞ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–æ–π –∏ –≤–≤–µ—Å—Ç–∏ –µ–≥–æ –≤ —ç—Ç–æ –ø–æ–ª–µ:

<p align="center"><img src="https://i.ibb.co/Rgj1sVj/2022-01-05-23-54-36.png" alt="2022-01-05-23-54-36" border="0"></p>

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å ssh –∫–ª—é—á, –Ω–∞ `MacOS` –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–π—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª, –Ω–∞ `Windows` - –≤—ã –º–æ–∂–µ—Ç–µ —Å–∫–∞—á–∞—Ç—å [git](https://git-scm.com/) - –≤ –∫–æ—Ç–æ—Ä—ã–π –≤—Ö–æ–¥–∏—Ç 
—É–ª–∏—Ç–∏—Ç–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—é—á–∞.  

```python
cd .ssh

mkdir <your_app_name>
cd <your_app_name>
ssh-keygen -t rsa

```
<p align="center"><img src="https://i.ibb.co/ChkD8qH/2022-01-06-00-00-42.png" alt="2022-01-06-00-00-42" border="0"></p>

–í–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∏–º—è –∫–ª—é—á–∞ –∏ —Å–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª–∏. –î–∞–ª—å—à–µ –≤–∞–º –ø—Ä–æ—Å—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ 
–≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã


```python
cat test_key.pub

```
–ö–æ–ø–∏—Ä—É–µ–º –≤—ã–≤–æ–¥ –∏ –Ω–∞–∂–∏–º–∞–µ–º —Å–æ–∑–¥–∞—Ç—å `–í–ú` –¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∫ –Ω–µ–π –ø–æ–¥–∫–ª—é—á–∏—Ç—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```python

ssh <–õ–û–ì–ò–ù>@<–ø—É–±–ª–∏—á–Ω—ã–π_IP-–∞–¥—Ä–µ—Å_–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã> 

```
–ü—É–±–ª–∏—á–Ω—ã–π –∞–¥—Ä–µ—Å –í–∞–º –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è. –î–∞–ª—å—à–µ, –∏–¥–µ–º [—Å—é–¥–∞](https://www.digitalocean.com/community/tutorials/docker-ubuntu-18-04-1-ru) –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞ –≤–∞—à—É `–í–ú` `Docker`. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –≤—Å–µ –∫–∞–∫ –∏ —É –≤–∞—Å –ª–æ–∫–∞–ª—å–Ω–æ:

```python
git clone https://github.com/ArtyKrafty/detection

cd detection

docker build . -f Dockerfile -t detectron2
docker run --rm --name detectron2 -p 8080:8080 detectron2

```
–ï—Å–ª–∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ `Docker` –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ `docker: Got permission denied issue` - –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É: `sudo chmod 666 /var/run/docker.sock`

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ —Ç—É—Ç:

```python

–ø—É–±–ª–∏—á–Ω—ã–π_IP-–∞–¥—Ä–µ—Å_–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã>:8080

```

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>

<h3 align="center">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</h3><a id='linkprobru'></a>


<p float="left">
  <img src='https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=for-the-badge&logo=PyTorch&logoColor=white'>
  <img src='https://img.shields.io/badge/numpy-%23013243.svg?style=for-the-badge&logo=numpy&logoColor=white'> 
  <img src='https://img.shields.io/badge/pandas-%23150458.svg?style=for-the-badge&logo=pandas&logoColor=white'> 
  <img src='https://img.shields.io/badge/opencv-%23white.svg?style=for-the-badge&logo=opencv&logoColor=white'> 
   <img src='https://img.shields.io/badge/flask-%23000.svg?style=for-the-badge&logo=flask&logoColor=white'> 
</p>

–ü—Ä–æ–±–ª–µ–º—ã –≤–æ–∑–Ω–∏–∫–∞—é—Ç –Ω–µ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –∞ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è - `Detectron2`, `torch` –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. 
–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–ª —Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –≤–∞–º –≤ —É—Å—Ç–∞–Ω–æ–≤–∫–µ, –µ—Å–ª–∏ –≤—ã —Ä–µ—à–∏—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —á–µ—Ä–µ–∑ `docker`. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –Ω–∞ `MacOs` –∏ `Windows` - –Ω–∞ `Win` - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `Microsoft Visual C++`. –î–∞–Ω–Ω—ã–π —Å–±–æ—Ä–Ω–∏–∫ –ø–æ–º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `torch` –∏ `Detectron2`. –¢–∞–∫–∂–µ, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é, —á—Ç–æ–±—ã —É –≤–∞—Å —É–∂–µ –±—ã–ª–∞ `Anaconda`

| –ò—Å—Ç–æ—á–Ω–∏–∫  |  –û–ø–∏—Å–∞–Ω–∏–µ |  –†–µ—à–µ–Ω–∏–µ |
|---|---|---|
| –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Web-app  | –ü–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞ `heroku` - `Application Error`  | –û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏. –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –µ—â–µ —Ä–∞–∑ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –∏–ª–∏ –≤–∑—è—Ç—å –¥—Ä—É–≥—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É. –° –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–æ–π –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç  |
|  torch, Detectron | C++ –æ—à–∏–±–∫–∞ –Ω–∞ Windows –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ `pycatools`  |  –£ –≤–∞—Å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Visual Studio C++ - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [–æ—Ç—Å—é–¥–∞](https://www.microsoft.com/ru-ru/download/confirmation.aspx?id=48159) |
| torch, torchvision  | —É—Å—Ç–∞—Ä–µ–≤—à–∞—è –≤–µ—Ä—Å–∏—è –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—é—â–∞—è –≤–∞—à–µ–º—É –ü–ö  | –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ [—Ç—É—Ç](https://pytorch.org/get-started/locally/)|
| torch  | `Torchvision error: Could not find module image.pyd`  | –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è [–∑–¥–µ—Å—å](https://kontext.tech/column/python/915/torchvision-error-could-not-find-module-imagepyd) —Å —Ä–µ—à–µ–Ω–∏–µ–º  |
| Docker  | –æ—à–∏–±–∫–∞ —Å `–°++` –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –∏–ª–∏ `os` | –∑–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `docker -> advanced` –∏ —É–≤–µ–ª–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å `RAM` —Å 2 –¥–æ 4 –ì–ë|

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>

<h3 align="center">–í—ã–≤–æ–¥</h3><a id='summru'></a>

–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ä–∞–±–æ—Ç—ã, —É–¥–∞–ª–æ—Å—å –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–≤–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª—è: –ª–æ–∫–∞–ª—å–Ω—ã–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `GPU` –∏ —Ä–∞–±–æ—Ç–æ–π —Å –≥—Ä—É–ø–ø–æ–π —Ñ–∞–π–ª–æ–≤ –∏ `web`-–≤–µ—Ä—Å–∏—é, 
–∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –µ–¥–∏–Ω–∏—á–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –î–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å —è–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥–∏–±–∫–∏–º, –≤ –Ω–µ–≥–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏, —É–ª—É—á—à–∞—Ç—å –∏—Ö –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –¥–æ–æ–±—É—á–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–¥ –Ω—É–∂–¥—ã –±–∏–∑–Ω–µ—Å–∞ –∏–ª–∏ –∏–Ω—ã—Ö –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü —Å –ø–æ–º–æ—â—å—é –æ–±—É—á–µ–Ω–∏—è –Ω–∞ —Å–≤–æ–µ —Å–µ—Ç–µ 
–∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

–î–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏, –Ω–µ —Ç–æ–ª—å–∫–æ `detectron` - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ª–∏—à—å –∑–∞–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö.

–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏, –º–æ–¥—É–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ –∏–ª–∏ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏, –∞ –≤ `web`-–≤–µ—Ä—Å–∏–∏ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–µ 
–≤–∞–∂–Ω–æ —É–º–µ—Ç—å –≤–ª–∞–¥–µ—Ç—å –Ω–∞–≤—ã–∫–∞–º–∏ —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞–º–∏ - –±–µ–∑ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏–µ–π - –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω –Ω–µ–∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞, 
–±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `Docker` –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–æ–¥—É–ª—è. –ï—Å–ª–∏ —É –≤–∞—Å –ø–æ—è–≤–∏—Ç—Å—è –∂–µ–ª–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ - –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è `D2go`, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π [—Ç—É—Ç](https://github.com/facebookresearch/d2go)

–°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏–µ

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>

<h3>–°—Å—ã–ª–∫–∏</h3><a id='linkru001'></a>

1. [–ö—É—Ä—Å Deep learning school](https://www.dlschool.org/pro-track) - –æ–±—É—á–∞—é—Ç –∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç. 
2. [Aros≈Çaw Gilewski](https://medium.com/deepvisionguru/modular-image-processing-pipeline-using-opencv-and-python-generators-9edca3ccb696) - –∏–Ω–∂–µ–Ω–µ—Ä CV. –ò–¥–µ—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ python –∏ –∑–∞ baseline —É–¥–∞–ª–µ–Ω–∏—è —Ñ–æ–Ω–∞. 
3. [Detectron2](https://github.com/facebookresearch/detectron2) - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Meta –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Å –æ–≥—Ä–æ–º–Ω—ã–º –∑–æ–æ–ø–∞—Ä–∫–æ–º –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.   
4. [OpenCV](https://opencv.org/) - —Å—Ä–µ–¥—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ë–µ–∑ —ç—Ç–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –±—ã–ª–æ –±—ã —Å–ª–æ–∂–Ω–µ–µ. 
5. [Heroku](https://www.heroku.com/) - –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. 
6. [pyTorch](https://pytorch.org/docs/stable/torch.html) - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–π—Ä–æ–Ω–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏  
7. [Docker](https://www.docker.com/) - —Å—Ä–µ–¥—Å—Ç–≤–æ —É–ø–∞–∫–æ–≤–∫–∏ –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π  
8. [MLWhiz](https://github.com/MLWhiz/object_detection) - –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–∑—Ü—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Ä–∞–∑–º–µ—Ç–∫–∏

----
<a href="#link6"><img src='https://img.shields.io/badge/–ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é-&#x21A9-blue'></a>

<br>
<br>
<br>
<br>
<br>
<br>

<a href="#RUS"><img src='https://img.shields.io/badge/ENG-RUS-blue'></a>
<a id='ENG'></a>


<p float="left">
  <img src='https://img.shields.io/badge/mac%20os-000000?style=for-the-badge&logo=macos&logoColor=F0F0F0'>
  <img src='https://img.shields.io/badge/Windows-0078D6?style=for-the-badge&logo=windows&logoColor=white'> 
  <img src='https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=ubuntu&logoColor=white'> 
  
   
</p>

<h2 align="center">Modular image and video processing with OpenCV and Detectron2. Pipeline, web-app and local-app </h2>


<p align="center"><img src='https://i.ibb.co/rbJmBSV/Computer-Vision-Object-Detection-original.jpg'></p>

<a id='link7'></a>


Table of content:  

- [Motivation](#link8)  
- [Local installation](#link9)  
   - [Script process_img.py](#link10)  
   - [Script process_video.py](#link11)   
- [Web-application](#link12) 
- [Dockerfile](#linkdock)
- [Virtual Machine](#linkvmeng)
- [Help desk](#linkprobeng)
- [Summary](#summeng)
- [Credits](#linkeng001)


---


üìù Web-Application is in sleep mode. It will take time to launch - about `30 sec`. Also, malfunctions are possible - the application is on a free server.
Photos are deleted after upload. The download is performed using the [Cloudinary](https://cloudinary.com/console/c-d40c93f179ad3e2d4db90096a7d9fe/getting-started), since `heroku` does not allow downloading the download to their servers.
Photos are deleted after upload.

<p align="center"><img src="https://i.ibb.co/X4W8wCw/2022-01-03-02-23-14.png" alt="2022-01-03-02-23-14" border="0"></p>


üìù The error may be related to out of memory. You can try again (push back in your browser and again push `–û—Ç–ø—Ä–∞–≤–∏—Ç—å`) or 
take another picture. There will be no problems with local assembly

> üìù `Update` - For convenience, the application has been additionally `temporarily for demonstration purposes` deployed to `VM` [Ya.Cloud](https://cloud.yandex.ru/services/compute?utm_source=google&utm_medium=cpc&utm_campaign=Search_RU_Other_All_LGEN_Compute_cloud|1665315027&utm_term=&utm_content=k50id|dsa-1095774648190|cid|1665315027|aid|536548145022|gid|115436434013|pos||src|g_|dvc|c|reg|9040981|rin||&gclid=Cj0KCQiA_c-OBhDFARIsAIFg3eyjfkECcbvr56__gTM6WeTu4I4CsK8_PNLkyYxi1niax0HbaNtwHrgaAp0jEALw_wcB) - available at [this link](http://51.250.20.81:8080/)

---


<h3 align="center">Motivation</h3><a id='link8'></a>

Modular image processing using [OpenCV](https://opencv.org/) and `Python` generators using [Detectron2](https://github.com/facebookresearch/detectron2). The idea of modularity allows the industrial processing pipeline to be programmed by several `DS` specialists. The idea of using generators is taken from [Aros≈Çaw Gilewski](https://medium.com/deepvisionguru/modular-image-processing-pipeline-using-opencv-and-python-generators-9edca3ccb696) - as a result, we get a full-fledged module that can be supplemented in the variations we need.

The aim of the work was to implement various approaches to integrating `Detectron2` and `OpenCV` into projects - both local and web using modules
or in the form of scripts using different versions of the models, as well as use various options for installing modules and fix
various ways to solve problems, contributing to the work with `torch` and` Detectron2` in the context of applications

> üìù If you do not have a link to `medium` - turn on incognito mode

1. **Local execution**. In this version, you can work with random images, or use a trained model for detection
weapons, including video. By expanding the training data, you can get more accurate results.
The interface allows, without delving into the code, to perform image segmentation, including shading the background.

  Available functionality:

      - Images:
        - Works with groups of image, not only single
        - Instance segmentation on images
        - Key points
        - Panoptic segmentation
        - Separate background
        - Weapon detection (custom data set)
      - Video:
        - Works with groups of vidoe, not only single
        - Instance segmentation on video
        - Show processing in real time
        - Weapon detection on video
        
  <p align="center"><img src="https://i.ibb.co/ZJSL1yL/2021-12-28-10-43-20.png" alt="2021-12-28-10-43-20" border="0"></p>
  
```python

-- module structure --

Images: process_img.py -> detection.pipe.py -> detction.capture_imgs.py ->
-> detection.predict.py -> detection.annotate_img.py or detection.separate_background.py ->
-> detection.save_img.py

Video: process_vid.py -> detection.pipe.py -> detection.capture_vid.py ->
-> detection.predict.py -> detection.annotate_vid.py ->
-> detection.save_vid.py -> detection.display_vid.py

```

2. **Web Application**. An additional web application with limited functionality has been implemented (only images) - Located at: https://detartyseg.herokuapp.com/ and at [this link in Ya.Cloud](http://51.250.20.81:8080/). Unfortunately, I had to cut the functionality due to the size restrictions for the application. Also, launching via [Docker](https://www.docker.com/) is possible - instructions in the corresponding part of the file [Readme.md](#linkdock) - locally, or after cloning the repository - launching via `app_local.py`

 Available functionality:

      - Images:
        - Works with single image
        - Instance segmentation on images
        - Keypoints on images
        - Panoptic segmentation (`Deleted from heroku. Available in docker and yaCloud`)
        - Separate background
        - Blur effect
        - Black and white image


<p align="center"><img src="https://i.ibb.co/mDCxTP3/2022-01-03-11-27-44.png" alt="2022-01-03-11-27-44" border="0"></p>

```python

-- module structure --

app.py works with Flask - loading css and html from static and templates. 
Uploading images via Api Cloudly

```


----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>


<h3 align="center">Local execution</h3><a id='link9'></a>
<h4> 1. Script process_img.py</h4><a id='link10'></a>

Here are five options for how the model works:

- `instance segmentation` into classes` COCO`
- `instance segmentation` for detecting weapons on a custom [dataset](https://github.com/ArtyKrafty/detection/blob/main/configs/COCO-InstanceSegmentation_weapon/weapon_data.tar). The images were taken from the [MLWhiz](https://github.com/MLWhiz/object_detection) repository, which I mapped out manually using [supervise.ly](https://supervise.ly/).

You can watch the training in this [notebook](https://nbviewer.org/github/ArtyKrafty/detection/blob/main/configs/COCO-InstanceSegmentation_weapon/weapon_detection_ipynb__.ipynb), if you want to train your detector (available in [Collab](https://colab.research.google.com/drive/1TOSFHYrQrxToQ4v5azP8xzpuLcgEKrQ3?usp=sharing)). The weights of the base models can be taken from the [zoo](https://github.com/facebookresearch/detectron2/blob/main/detectron2/model_zoo/model_zoo.py) - form `.yaml` similarly to those presented in the` config` folder
- `separate background` - separation of the background, instead of annotation. Idea suggested by [Aros≈Çaw Gilewski](https://medium.com/deepvisionguru/how-to-embed-detectron2-in-your-computer-vision-project-817f29149461)
- `keypoints` - for building key points of people on images (` pose-flow`). 

For ease of launch, a simple `GUI` was added to this module, using [GOOEY](https://github.com/chriskiehl/Gooey)

---

<h3 align="center">Local Installation</h3>

---



It is recommended to install to `virtuenv`. Optional step - can be skipped

```python
pip install virtualenv
virtualenv detection
source detection/bin/activate
```


It is also recommended to read the instructions to the end before starting the installation. For `Win` it is recommended to use` Ubuntu 20.04.3 LTS` with `WLS2` or` Conda` terminal. It is desirable that you already have [Anaconda](https://www.anaconda.com/products/individual)


Module configuration steps.

```python
git clone https://github.com/ArtyKrafty/detection
pip install -r requirements_loc.txt
```

Detectron2 must be installed in the adjacent directory with the module folder

<p align="center"><img src="https://i.ibb.co/R25y4Lx/2021-12-26-19-35-04.png" alt="2021-12-26-19-35-04" border="0"></p>

`Detectron2` installation

```python
cd

git clone https://github.com/facebookresearch/detectron2.git
python -m pip install -e detectron2

# On macOS, you need to install like this (especially if you have M1
CC=clang CXX=clang++ ARCHFLAGS="-arch x86_64" python -m pip install -e detectron2

If you have any difficulties, you can refer to the official documentation

the most common problem is the lack of a C ++ compiler:
conda install -c conda-forge compilers

```
[Detectron2 Official Installation Guide](https://github.com/facebookresearch/detectron2/blob/3def12bdeaacd35c6f7b3b6c0097b7bc31f31ba4/INSTALL.md).  
[Official Installation Guide for Detectron2. Installation](https://detectron2.readthedocs.io/en/latest/tutorials/install.html)

For `Win`, you must have `Visual C++ 2015 build tools` installed
If not, install [from here](https://www.microsoft.com/en-ru/download/confirmation.aspx?id=48159) - this is required for [Detectron2](https://github.com/philferriere/cocoapi)


Also, it is recommended to check the version of `torch` and `torchvision` - you can check [here](https://pytorch.org/get-started/locally/) - select Package - copy the command to install


<p align="center"><img src="https://i.ibb.co/wc1NPMq/123.jpg" alt="123" border="0"></p>


> üìù If you get an error - `Torchvision error: Could not find module image.pyd` - I recommend reading [here](https://kontext.tech/column/python/915/torchvision-error-could-not-find-module-imagepyd) with solution

For example, for `CPU`:

```python
pip3 install torch torchvision torchaudio
–∏–ª–∏
conda install pytorch torchvision cpuonly -c pytorch

```

---

<h3 align="center">Module usage</h3>

---


1. `Instance segmentation` with `COCO`

```python
Open terminal

cd detection
pythonw process_img.py

```

> üìù Note that the call is made through `pythonw`, not` python` or `python3`

A window will open:

<p align="center"><img src="https://i.ibb.co/ZJSL1yL/2021-12-28-10-43-20.png" alt="2021-12-28-10-43-20" border="0"></p>


```python
You must set input. These are the images on which objects will be predicted.
You can use my photos - folder

./examples/images/photo/

also you can choose the confidence threshold.
Press START and in the outputs folder you have processed images
```
<p align="center"><img src="https://i.ibb.co/pz0Twxx/0299ce77-30e4-4b31-b8e5-fad85b140111.jpg" alt="0299ce77-30e4-4b31-b8e5-fad85b140111" border="0"></p>

> on standard models of problems with working out the main classes in the `COCO` dataset

2. `Instance segmentation` for detecting weapons on a custom [dataset](https://github.com/ArtyKrafty/detection/blob/main/configs/COCO-InstanceSegmentation_weapon/weapon_data.tar). The class names had to be neglected - otherwise they lost in universality. If you collect a larger set, you can use similar models to detect whether a person has a weapon

```python
Open terminal

cd detection
pythonw process_img.py

```

> üìù Note that the call is made through `pythonw`, not` python` or `python3`

A window will open:

<p align="center"><img src="https://i.ibb.co/1TmBmfX/2021-12-28-10-10-42.png" alt="2021-12-28-10-10-42" border="0"></p>


```python
You must set input. These are the images on which objects will be predicted.
You can use my photos - folder

./examples/images/weapon/

also you can choose the confidence threshold. Here you need to change the model -
you will find the needed one in the config folder (and weights to it):


path ./detection/configs/COCO-InstanceSegmentation_weapon/mask_rcnn_R_50_FPN_3x.yaml.
We load weights to it: ./detection/configs/COCO-InstanceSegmentation_weapon/model_final.pth
Press START and in the outputs folder you have processed images
```
<p align="center"><img src="https://i.ibb.co/8M9Bt3T/new-use-hotel-robber-with-gun-2.jpg" alt="new-use-hotel-robber-with-gun-2" border="0"></p>

> here I had to sacrifice the class dictionary to have universality - weapons were not the main purpose of this application,
> was used as an example of how the model can be applied in the real world to real-world problems, as well as to show
> `baseline` training your detector

3. Separating the background - works the same way - just check the separate_background

```python
You must set input. These are the images on which objects will be predicted.
You can use my photos - folder

./examples/images/photos/

also you can choose the confidence threshold. Here you need to change the model -
you will find the needed one in the config folder (and weights to it):


path ./detection/configs/COCO-InstanceSegmentation/mask_rcnn_R_50_FPN_3x.yaml.
We put a mark - separate background:
Press START and in the outputs folder you have processed images

```

Getting an image with a blur effect on the background

<p align="center"><img src="https://i.ibb.co/Q9m5nHh/004.jpg" alt="004" border="0"></p>

> my favorite feature of this application - it helps to do a little processing of your photo without `photoshop` skills

4. Building key points - works similarly to weapons - just specify the address to the configuration
```python
You must set input. These are the images on which objects will be predicted.
You can use my photos - folder

./examples/images/key_points/

also you can choose the confidence threshold. Here you need to change the model -
you will find the needed one in the config folder (and weights to it):


path ./detection/configs/COCO-Keypoints/keypoint_rcnn_R_50_FPN_3x.yaml.
Press START and in the outputs folder you have processed images

There is no need to set weights.

```
We get an image with marked key points.


<p align="center"><img src="https://i.ibb.co/0KY5Jh1/predict.jpg" alt="predict" border="0"></p>

> there are inaccuracies here, the model does not do it perfectly. Improvements are possible through the introduction of another `pose flow` technology.
> for example, you can take a solution from YuliangXiu [here](https://github.com/YuliangXiu/PoseFlow)

5. Panoptic group of images - just specify the address to the configuration

```python
You must set input. These are the images on which objects will be predicted.
You can use my photos - folder

./examples/images/pan/

also you can choose the confidence threshold. Here you need to change the model -
you will find the needed one in the config folder (and weights to it):


path ./detection/configs/COCO-PanopticSegmentation/panoptic_fpn_R_101_3x.yaml
Press START and in the outputs folder you have processed images

There is no need to set weights.

```

<p align="center"><img src="https://i.ibb.co/Zx9zB1g/predict.jpg" alt="predict" border="0"></p>

> panoptic segmentation is also successful, but not completely - you can take a more complex and deeper model
> either choose another framework, or simply retrain by putting together a set

The goal was to demonstrate various options for the model without delving into the code on the part of the user of this module - it is enough to specify the address to the configuration

----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>

<h4> 2. Script process_video.py</h4><a id='link11'></a>

This module is designed to process video and display the processing result, if necessary.

---

<h3 align="center">Module usage</h3>

---


`Instance segmentation` with `COCO`

```python
Open terminal

cd detection
pythonw process_video.py

```

> üìù Note that the call is made through `pythonw`, not` python` or `python3`. The principle of operation is similar. Weapons can also be detected -
for ethical reasons - it was customary not to add the file with armed attacks to the repository

A window will open:

<p align="center"><img src="https://i.ibb.co/KKBhVRy/2021-12-27-23-26-40.png" alt="2021-12-27-23-26-40" border="0"></p>

```python
You must set input. This is a video in which objects will be predicted.
You can use my example

./examples/videos/cross_roads.mp4

also you can choose the confidence threshold.
Press START and in the outputs folder you have the processed video. Takes some time

```
> üìù Important! At the moment, there is a [bug](https://github.com/facebookresearch/detectron2/issues/3780) for the class
`VideoVisualizer`. To get around it, the `Visualizer` class was used, which is used for images
therefore the masks change from frame to frame. Probably the bug is only observed on M1 silicone

<p align="center">
  <img src="sample.gif" alt="animated" />
</p>

> in fact, of the minuses - we observe the variability of the color of the mask, ideally - the mask should be static and not change color. Presently,
> had to resort to a trick - to use frame markup and glue them in the video after processing

----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>

<h3 align="center">Web-application</h3><a id='link12'></a>
Script app_local.py - for local work


mirror for `app.py`, which is located at: https://detartyseg.herokuapp.com/ and in [yaCloud](http://51.250.20.81:8080/) 
Unfortunately - I had to cut the functionality, due to the size restrictions for the application. I had to remove the `panoptic segmentation` -
memory excess on the application, on a free server. Remained functional in the local application and `docker`
If you want to use the [heroku](https://dashboard.heroku.com/login) service  - you just need to create a repository with your application,
and you will have access to - `deploy from git`

<p align="center"><img src="https://i.ibb.co/p1KVj69/2022-01-06-00-11-48.png" alt="2022-01-06-00-11-48" border="0"></p>

If you want to run locally, run `app_local.py`, but you need `torch` and `detectron2`:


```python
 git clone https://github.com/ArtyKrafty/detection
 cd detection
 python app_local.py
 
```

An application with limited functionality will start at the address - `http: // YOUR_URL_from_terminal: 8080 /`


<p align="center"><img src="https://i.ibb.co/mDCxTP3/2022-01-03-11-27-44.png" alt="2022-01-03-11-27-44" border="0"></p>

Here you can load an image from the desktop, select masks on it or darken the background. It is also possible to download images by `URL` - only instance segmentation

----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>

<h3 align="center">Dockerfile</h3><a id='linkdock'></a>


Another option is to run via Docker (local copy of https://detartyseg.herokuapp.com/) - weight of Image 14.4 GB:

```python
git clone https://github.com/ArtyKrafty/detection
cd detection

docker build . -f Dockerfile -t detectron2
docker run --name detectron2 -p 127.0.0.1:8080:8080 detectron2


and after finish:

docker stop detectron2
docker rm $(docker ps -a -q)

or you can use docker-desktop app
look files inside: docker run -t -i detectron2 /bin/bash
```

<p align="center"><img src="https://i.ibb.co/FwgVWJn/123.jpg" alt="123" border="0"></p>

You can also run the application on your `VM` using the `Dockerfile`.

> üìù If you `MacOS` user - go to` docker -> advanced` settings and increase `RAM` from 2 to 4 GB - otherwise` C ++ `compiler
can't build `torch`. 


----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>


<h3 align="center">Virtual machine</h3><a id='linkvmeng'></a>

With the `Dockerfile` you can install a` web application` on a virtual machine. Minimum requirements for `Vm` -` 8gb Ram`, `vCpu - 50%`,
`20Gb HDD`.

We register on any service that provides VM services - for example, I used [Ya.Cloud](https://cloud.yandex.ru/?utm_source=google&utm_medium=cpc&utm_campaign=Search_RU_Msk_All_LGEN_Brand_cloud|8671134894&utm_term=%D1%8F%D0%BD%D0%B4%D0%B5%D0%BA%D1%81%20%D0%BA%D0%BB%D0%B0%D1%83%D0%B4&utm_content=k50id|kwd-972722615673|cid|8671134894|aid|428872413994|gid|85184818777|pos||src|g_|dvc|c|reg|9040981|rin|9047023|&gclid=Cj0KCQiAoNWOBhCwARIsAAiHnEjpHDU6WbRvwmOl1NYDg5M5Zi_pZ-bc0dDwlu8sDRvP555cSH-W4bQaApuWEALw_wcB)

In the console, select - `Compute Cloud`:

<p align="center"><img src="https://i.ibb.co/qFrKRnF/2022-01-05-23-54-18.png" alt="2022-01-05-23-54-18" border="0"></p>

We select `Ubuntu` as the operating system of our VM:

<p align="center"><img src="https://i.ibb.co/RYgXGZR/2022-01-05-23-54-30.png" alt="2022-01-05-23-54-30" border="0"></p>

We need to create an `ssh-key` to communicate with the virtual machine and enter it in this field:

<p align="center"><img src="https://i.ibb.co/Rgj1sVj/2022-01-05-23-54-36.png" alt="2022-01-05-23-54-36" border="0"></p>

In order to create an ssh key, on `MacOS` just go to the terminal, on` Windows` - you can download [git](https://git-scm.com/) - which includes
the utility needed to create the key.

```python
cd .ssh

mkdir <your_app_name>
cd <your_app_name>
ssh-keygen -t rsa

```
<p align="center"><img src="https://i.ibb.co/ChkD8qH/2022-01-06-00-00-42.png" alt="2022-01-06-00-00-42" border="0"></p>

You will be prompted to create a key name and create passwords. Then you just need to read your public key and copy the output
in a special field of the virtual machine


```python
cat test_key.pub

```
Copy the output and click create VM. Now we can connect to it in the terminal:

```python

ssh <LOGIN>@<public_IP_VM> 

```
The public address will be available to you after creation. Next, go [here](https://www.digitalocean.com/community/tutorials/docker-ubuntu-18-04-1-ru) and install Docker on your VM. After installation. everything is the same as yours locally:

```python
git clone https://github.com/ArtyKrafty/detection

cd detection

docker build . -f Dockerfile -t detectron2
docker run --rm --name detectron2 -p 8080:8080 detectron2

```
If during building `Docker` the error` docker: Got permission denied issue` occurs - just execute the command: `sudo chmod 666/var/run/docker.sock`

The application will be available here:

```python

public_IP_VM:8080

```

----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>

<h3 align="center">Help desk</h3><a id='linkprobeng'></a>


<p float="left">
  <img src='https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=for-the-badge&logo=PyTorch&logoColor=white'>
  <img src='https://img.shields.io/badge/numpy-%23013243.svg?style=for-the-badge&logo=numpy&logoColor=white'> 
  <img src='https://img.shields.io/badge/pandas-%23150458.svg?style=for-the-badge&logo=pandas&logoColor=white'> 
  <img src='https://img.shields.io/badge/opencv-%23white.svg?style=for-the-badge&logo=opencv&logoColor=white'> 
   <img src='https://img.shields.io/badge/flask-%23000.svg?style=for-the-badge&logo=flask&logoColor=white'> 
</p>

Problems do not arise with the application, but problems may arise when problems arise - `Detectron2`,` torch` and so on.
Here are some solutions to help you install if you choose to work outside of `docker`. Tested on `MacOs` and` Windows` - on `Win` - the main problem is the lack of` Microsoft Visual C++ `. This collection will help to solve the main problems when installing `torch` and` Detectron2`. Also, it is recommended to have Anaconda on board

| Problem  |  Description |  Solution |
|---|---|---|
| Web-app | Error `heroku` -` Application Error` appears | The error may be related to out of memory. You can try again to perform the action or take another picture. There will be no problems with local assembly |
| torch, Detectron | C ++ error on Windows when installing on `pycatools` | You do not have Visual Studio C ++ installed - the compiler is missing. Install [from here](https://www.microsoft.com/ru-ru/download/confirmation.aspx?id=48159) |
| torch, torchvision | outdated version or installed not matching your PC | you can check [here](https://pytorch.org/get-started/locally/) |
| torch | `Torchvision error: Could not find module image.pyd` | read [here](https://kontext.tech/column/python/915/torchvision-error-could-not-find-module-imagepyd) with a solution |
| Docker | error with `C ++` on assembly or `os` | go to `docker -> advanced` settings and increase the` RAM` memory from 2 GB to 4 GB |

----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>

<h3 align="center">Summary</h3><a id='summeng'></a>

Based on the results of the work, it was possible to build two full-fledged modules: a local one with `GPU` support and work with a group of files and a` web` version, Which works with single images without the need for setup and installation. This module is flexible enough, it is possible to add new models to it that improve their quality through additional training or overstretch for the needs of business or other individuals through training on their own network.
and embedding models by adding new configurations

This module can be used with other models and frameworks, not only `detectron` - you just need to replace the models in the executable files.

In the local version, the module can be used by advanced developers or interested parties, and in the `web` version - by users who do not
it is important to be proficient with detectors - without significant effort - some result may be obtained. For comfort,
`Docker` support has been implemented and detailed instructions for configuring the module have been added. If you have a desire to implement the application
for mobiles - you can use `D2go` repository [here](https://github.com/facebookresearch/d2go)   

Thanks for reading

----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>

<h3>Credits</h3><a id='linkeng001'></a>

1. [Deep learning school](https://www.dlschool.org/pro-track) - educate and guide.  
2. [Aros≈Çaw Gilewski](https://medium.com/deepvisionguru/modular-image-processing-pipeline-using-opencv-and-python-generators-9edca3ccb696) - CV engineer. Idea of using pipelines and separate background baseline.   
3. [Detectron2](https://github.com/facebookresearch/detectron2) - Meta library for working with images  
4. [OpenCV](https://opencv.org/) - video and image processing tool  
5. [Heroku](https://www.heroku.com/) - a fast way to develop and host applications  
6. [pyTorch](https://pytorch.org/docs/stable/torch.html) - framework for working with neural networks  
7. [Docker](https://www.docker.com/) - packaging and image transfer tool
8. [MLWhiz](https://github.com/MLWhiz/object_detection) - provided sample images for markup


----
<a href="#link7"><img src='https://img.shields.io/badge/Back to content-&#x21A9-blue'></a>
